<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Graphics in R | R Programming for Data Sciences</title>
  <meta name="description" content="Chapter 5 Graphics in R | R Programming for Data Sciences" />
  <meta name="generator" content="bookdown 0.10 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Graphics in R | R Programming for Data Sciences" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Graphics in R | R Programming for Data Sciences" />
  
  
  

<meta name="author" content="Andrew O. Finley, Vince Melfi, Jeffrey W. Doser" />


<meta name="date" content="2019-05-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="structures.html">
<link rel="next" href="data2.html">
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Course Description</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>2</b> Introduction to R and RStudio</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#obtaining-and-installing-r"><i class="fa fa-check"></i><b>2.1</b> Obtaining and Installing R</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#obtaining-and-installing-rstudio"><i class="fa fa-check"></i><b>2.2</b> Obtaining and Installing RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#using-r-and-rstudio"><i class="fa fa-check"></i><b>2.3</b> Using R and RStudio</a><ul>
<li class="chapter" data-level="2.3.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#r-as-a-calculator"><i class="fa fa-check"></i><b>2.3.1</b> R as a Calculator</a></li>
<li class="chapter" data-level="2.3.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#dec"><i class="fa fa-check"></i><b>2.3.2</b> Basic descriptive statistics and graphics in R</a></li>
<li class="chapter" data-level="2.3.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#an-initial-tour-of-rstudio"><i class="fa fa-check"></i><b>2.3.3</b> An Initial Tour of RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#getting-help"><i class="fa fa-check"></i><b>2.4</b> Getting Help</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#workspace-working-directory-and-keeping-organized"><i class="fa fa-check"></i><b>2.5</b> Workspace, Working Directory, and Keeping Organized</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#quality-of-r-code"><i class="fa fa-check"></i><b>2.6</b> Quality of R code</a><ul>
<li class="chapter" data-level="2.6.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#naming-files"><i class="fa fa-check"></i><b>2.6.1</b> Naming Files</a></li>
<li class="chapter" data-level="2.6.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#naming-variables"><i class="fa fa-check"></i><b>2.6.2</b> Naming Variables</a></li>
<li class="chapter" data-level="2.6.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#syntax"><i class="fa fa-check"></i><b>2.6.3</b> Syntax</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="scripts-and-r-markdown.html"><a href="scripts-and-r-markdown.html"><i class="fa fa-check"></i><b>3</b> Scripts and R Markdown</a><ul>
<li class="chapter" data-level="3.1" data-path="scripts-and-r-markdown.html"><a href="scripts-and-r-markdown.html#scripts-in-r"><i class="fa fa-check"></i><b>3.1</b> Scripts in R</a></li>
<li class="chapter" data-level="3.2" data-path="scripts-and-r-markdown.html"><a href="scripts-and-r-markdown.html#r-markdown"><i class="fa fa-check"></i><b>3.2</b> R Markdown</a><ul>
<li class="chapter" data-level="3.2.1" data-path="scripts-and-r-markdown.html"><a href="scripts-and-r-markdown.html#creating-and-processing-r-markdown-documents"><i class="fa fa-check"></i><b>3.2.1</b> Creating and Processing R Markdown Documents</a></li>
<li class="chapter" data-level="3.2.2" data-path="scripts-and-r-markdown.html"><a href="scripts-and-r-markdown.html#output-formats-other-than-html"><i class="fa fa-check"></i><b>3.2.2</b> Output Formats other than HTML</a></li>
<li class="chapter" data-level="3.2.3" data-path="scripts-and-r-markdown.html"><a href="scripts-and-r-markdown.html#latex-knitr-and-bookdown"><i class="fa fa-check"></i><b>3.2.3</b> LaTeX, <code>knitr</code>, and <code>bookdown</code></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="scripts-and-r-markdown.html"><a href="scripts-and-r-markdown.html#practice-exercises"><i class="fa fa-check"></i><b>3.3</b> Practice Exercises</a></li>
<li class="chapter" data-level="3.4" data-path="scripts-and-r-markdown.html"><a href="scripts-and-r-markdown.html#homework"><i class="fa fa-check"></i><b>3.4</b> Homework</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="structures.html"><a href="structures.html"><i class="fa fa-check"></i><b>4</b> Data Structures</a><ul>
<li class="chapter" data-level="4.1" data-path="structures.html"><a href="structures.html#vector"><i class="fa fa-check"></i><b>4.1</b> Vectors</a><ul>
<li class="chapter" data-level="4.1.1" data-path="structures.html"><a href="structures.html#types-conversion-coercion"><i class="fa fa-check"></i><b>4.1.1</b> Types, Conversion, Coercion</a></li>
<li class="chapter" data-level="4.1.2" data-path="structures.html"><a href="structures.html#accessing-specific-elements-of-vectors"><i class="fa fa-check"></i><b>4.1.2</b> Accessing Specific Elements of Vectors</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="structures.html"><a href="structures.html#factors"><i class="fa fa-check"></i><b>4.2</b> Factors</a></li>
<li class="chapter" data-level="4.3" data-path="structures.html"><a href="structures.html#names-of-objects-in-r"><i class="fa fa-check"></i><b>4.3</b> Names of Objects in R</a></li>
<li class="chapter" data-level="4.4" data-path="structures.html"><a href="structures.html#missing-data-infinity-etc."><i class="fa fa-check"></i><b>4.4</b> Missing Data, Infinity, etc.</a><ul>
<li class="chapter" data-level="4.4.1" data-path="structures.html"><a href="structures.html#infinity-and-nan"><i class="fa fa-check"></i><b>4.4.1</b> Infinity and NaN</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="structures.html"><a href="structures.html#dataFrames"><i class="fa fa-check"></i><b>4.5</b> Data Frames</a><ul>
<li class="chapter" data-level="4.5.1" data-path="structures.html"><a href="structures.html#accessing-specific-elements-of-data-frames"><i class="fa fa-check"></i><b>4.5.1</b> Accessing Specific Elements of Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="structures.html"><a href="structures.html#lists"><i class="fa fa-check"></i><b>4.6</b> Lists</a><ul>
<li class="chapter" data-level="4.6.1" data-path="structures.html"><a href="structures.html#accessing-specific-elements-of-lists"><i class="fa fa-check"></i><b>4.6.1</b> Accessing Specific Elements of Lists</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="structures.html"><a href="structures.html#subsetting"><i class="fa fa-check"></i><b>4.7</b> Subsetting with Logical Vectors</a><ul>
<li class="chapter" data-level="4.7.1" data-path="structures.html"><a href="structures.html#modifying-or-creating-objects-via-subsetting"><i class="fa fa-check"></i><b>4.7.1</b> Modifying or Creating Objects via Subsetting</a></li>
<li class="chapter" data-level="4.7.2" data-path="structures.html"><a href="structures.html#logical-subsetting-and-data-frames"><i class="fa fa-check"></i><b>4.7.2</b> Logical Subsetting and Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="structures.html"><a href="structures.html#patterned-data"><i class="fa fa-check"></i><b>4.8</b> Patterned Data</a></li>
<li class="chapter" data-level="4.9" data-path="structures.html"><a href="structures.html#practice-exercises-1"><i class="fa fa-check"></i><b>4.9</b> Practice Exercises</a></li>
<li class="chapter" data-level="4.10" data-path="structures.html"><a href="structures.html#homework-1"><i class="fa fa-check"></i><b>4.10</b> Homework</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="graphics-in-r.html"><a href="graphics-in-r.html"><i class="fa fa-check"></i><b>5</b> Graphics in R</a><ul>
<li class="chapter" data-level="5.1" data-path="graphics-in-r.html"><a href="graphics-in-r.html#scatter-plots"><i class="fa fa-check"></i><b>5.1</b> Scatter Plots</a><ul>
<li class="chapter" data-level="5.1.1" data-path="graphics-in-r.html"><a href="graphics-in-r.html#structure-of-a-typical-ggplot"><i class="fa fa-check"></i><b>5.1.1</b> Structure of a Typical <code>ggplot</code></a></li>
<li class="chapter" data-level="5.1.2" data-path="graphics-in-r.html"><a href="graphics-in-r.html#adding-lines-to-a-scatter-plot"><i class="fa fa-check"></i><b>5.1.2</b> Adding lines to a scatter plot</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="graphics-in-r.html"><a href="graphics-in-r.html#labels-axes-text-etc."><i class="fa fa-check"></i><b>5.2</b> Labels, Axes, Text, etc.</a><ul>
<li class="chapter" data-level="5.2.1" data-path="graphics-in-r.html"><a href="graphics-in-r.html#labels"><i class="fa fa-check"></i><b>5.2.1</b> Labels</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="graphics-in-r.html"><a href="graphics-in-r.html#customizing-axes"><i class="fa fa-check"></i><b>5.3</b> Customizing Axes</a><ul>
<li class="chapter" data-level="5.3.1" data-path="graphics-in-r.html"><a href="graphics-in-r.html#text-point-size-and-color"><i class="fa fa-check"></i><b>5.3.1</b> Text, Point Size, and Color</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="graphics-in-r.html"><a href="graphics-in-r.html#other-types-of-graphics"><i class="fa fa-check"></i><b>5.4</b> Other Types of Graphics</a><ul>
<li class="chapter" data-level="5.4.1" data-path="graphics-in-r.html"><a href="graphics-in-r.html#histograms"><i class="fa fa-check"></i><b>5.4.1</b> Histograms</a></li>
<li class="chapter" data-level="5.4.2" data-path="graphics-in-r.html"><a href="graphics-in-r.html#boxplots"><i class="fa fa-check"></i><b>5.4.2</b> Boxplots</a></li>
<li class="chapter" data-level="5.4.3" data-path="graphics-in-r.html"><a href="graphics-in-r.html#bar-graphs"><i class="fa fa-check"></i><b>5.4.3</b> Bar Graphs</a></li>
<li class="chapter" data-level="5.4.4" data-path="graphics-in-r.html"><a href="graphics-in-r.html#graphs-of-functions"><i class="fa fa-check"></i><b>5.4.4</b> Graphs of Functions</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="graphics-in-r.html"><a href="graphics-in-r.html#themes"><i class="fa fa-check"></i><b>5.5</b> Themes</a></li>
<li class="chapter" data-level="5.6" data-path="graphics-in-r.html"><a href="graphics-in-r.html#saving-graphics"><i class="fa fa-check"></i><b>5.6</b> Saving Graphics</a></li>
<li class="chapter" data-level="5.7" data-path="graphics-in-r.html"><a href="graphics-in-r.html#more-resources"><i class="fa fa-check"></i><b>5.7</b> More Resources</a></li>
<li class="chapter" data-level="5.8" data-path="graphics-in-r.html"><a href="graphics-in-r.html#practice-exercises-2"><i class="fa fa-check"></i><b>5.8</b> Practice Exercises</a></li>
<li class="chapter" data-level="5.9" data-path="graphics-in-r.html"><a href="graphics-in-r.html#homework-2"><i class="fa fa-check"></i><b>5.9</b> Homework</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data2.html"><a href="data2.html"><i class="fa fa-check"></i><b>6</b> Working with Data</a><ul>
<li class="chapter" data-level="6.1" data-path="data2.html"><a href="data2.html#reading-data-into-r"><i class="fa fa-check"></i><b>6.1</b> Reading Data into R</a></li>
<li class="chapter" data-level="6.2" data-path="data2.html"><a href="data2.html#reading-data-with-missing-observations"><i class="fa fa-check"></i><b>6.2</b> Reading Data with Missing Observations</a></li>
<li class="chapter" data-level="6.3" data-path="data2.html"><a href="data2.html#summarizing-data-frames"><i class="fa fa-check"></i><b>6.3</b> Summarizing Data Frames</a><ul>
<li class="chapter" data-level="6.3.1" data-path="data2.html"><a href="data2.html#column-and-row-summaries"><i class="fa fa-check"></i><b>6.3.1</b> Column (and Row) Summaries</a></li>
<li class="chapter" data-level="6.3.2" data-path="data2.html"><a href="data2.html#apply"><i class="fa fa-check"></i><b>6.3.2</b> The <code>apply()</code> Function</a></li>
<li class="chapter" data-level="6.3.3" data-path="data2.html"><a href="data2.html#saving-typing-using-with"><i class="fa fa-check"></i><b>6.3.3</b> Saving Typing Using <code>with()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="data2.html"><a href="data2.html#transforming-a-data-frame"><i class="fa fa-check"></i><b>6.4</b> Transforming a Data Frame</a><ul>
<li class="chapter" data-level="6.4.1" data-path="data2.html"><a href="data2.html#adding-variables"><i class="fa fa-check"></i><b>6.4.1</b> Adding Variables</a></li>
<li class="chapter" data-level="6.4.2" data-path="data2.html"><a href="data2.html#removing-variables"><i class="fa fa-check"></i><b>6.4.2</b> Removing Variables</a></li>
<li class="chapter" data-level="6.4.3" data-path="data2.html"><a href="data2.html#transforming-variables"><i class="fa fa-check"></i><b>6.4.3</b> Transforming Variables</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="data2.html"><a href="data2.html#rearranging-variables"><i class="fa fa-check"></i><b>6.5</b> Rearranging Variables</a></li>
<li class="chapter" data-level="6.6" data-path="data2.html"><a href="data2.html#reshaping-data"><i class="fa fa-check"></i><b>6.6</b> Reshaping Data</a><ul>
<li class="chapter" data-level="6.6.1" data-path="data2.html"><a href="data2.html#tidyr"><i class="fa fa-check"></i><b>6.6.1</b> <code>tidyr</code></a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="data2.html"><a href="data2.html#manipulating-data-with-dplyr-dplyr"><i class="fa fa-check"></i><b>6.7</b> Manipulating Data with <code>dplyr</code> #{dplyr}</a><ul>
<li class="chapter" data-level="6.7.1" data-path="data2.html"><a href="data2.html#improved-data-frames"><i class="fa fa-check"></i><b>6.7.1</b> Improved Data Frames</a></li>
<li class="chapter" data-level="6.7.2" data-path="data2.html"><a href="data2.html#filtering-data-by-row"><i class="fa fa-check"></i><b>6.7.2</b> Filtering Data by Row</a></li>
<li class="chapter" data-level="6.7.3" data-path="data2.html"><a href="data2.html#selecting-variables-by-column"><i class="fa fa-check"></i><b>6.7.3</b> Selecting variables by column</a></li>
<li class="chapter" data-level="6.7.4" data-path="data2.html"><a href="data2.html#pipes"><i class="fa fa-check"></i><b>6.7.4</b> Pipes</a></li>
<li class="chapter" data-level="6.7.5" data-path="data2.html"><a href="data2.html#arranging-data-by-row"><i class="fa fa-check"></i><b>6.7.5</b> Arranging Data by Row</a></li>
<li class="chapter" data-level="6.7.6" data-path="data2.html"><a href="data2.html#renaming-variables"><i class="fa fa-check"></i><b>6.7.6</b> Renaming Variables</a></li>
<li class="chapter" data-level="6.7.7" data-path="data2.html"><a href="data2.html#data-summaries-and-grouping"><i class="fa fa-check"></i><b>6.7.7</b> Data Summaries and Grouping</a></li>
<li class="chapter" data-level="6.7.8" data-path="data2.html"><a href="data2.html#creating-new-variables"><i class="fa fa-check"></i><b>6.7.8</b> Creating New Variables</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="data2.html"><a href="data2.html#practice-exercises-3"><i class="fa fa-check"></i><b>6.8</b> Practice Exercises</a></li>
<li class="chapter" data-level="6.9" data-path="data2.html"><a href="data2.html#homework-3"><i class="fa fa-check"></i><b>6.9</b> Homework</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="functions-and-programming.html"><a href="functions-and-programming.html"><i class="fa fa-check"></i><b>7</b> Functions and Programming</a><ul>
<li class="chapter" data-level="7.1" data-path="functions-and-programming.html"><a href="functions-and-programming.html#r-functions"><i class="fa fa-check"></i><b>7.1</b> R Functions</a><ul>
<li class="chapter" data-level="7.1.1" data-path="functions-and-programming.html"><a href="functions-and-programming.html#creating-functions"><i class="fa fa-check"></i><b>7.1.1</b> Creating Functions</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="functions-and-programming.html"><a href="functions-and-programming.html#programming-conditional-statements"><i class="fa fa-check"></i><b>7.2</b> Programming: Conditional Statements</a><ul>
<li class="chapter" data-level="7.2.1" data-path="functions-and-programming.html"><a href="functions-and-programming.html#comparison-and-logical-operators"><i class="fa fa-check"></i><b>7.2.1</b> Comparison and Logical Operators</a></li>
<li class="chapter" data-level="7.2.2" data-path="functions-and-programming.html"><a href="functions-and-programming.html#if-else-statements"><i class="fa fa-check"></i><b>7.2.2</b> If else statements</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="functions-and-programming.html"><a href="functions-and-programming.html#arith"><i class="fa fa-check"></i><b>7.3</b> Computer Arithmetic</a></li>
<li class="chapter" data-level="7.4" data-path="functions-and-programming.html"><a href="functions-and-programming.html#loops"><i class="fa fa-check"></i><b>7.4</b> Loops</a><ul>
<li class="chapter" data-level="7.4.1" data-path="functions-and-programming.html"><a href="functions-and-programming.html#a-repeat-loop"><i class="fa fa-check"></i><b>7.4.1</b> A Repeat Loop</a></li>
<li class="chapter" data-level="7.4.2" data-path="functions-and-programming.html"><a href="functions-and-programming.html#a-while-loop"><i class="fa fa-check"></i><b>7.4.2</b> A While Loop</a></li>
<li class="chapter" data-level="7.4.3" data-path="functions-and-programming.html"><a href="functions-and-programming.html#a-for-loop"><i class="fa fa-check"></i><b>7.4.3</b> A For Loop</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="functions-and-programming.html"><a href="functions-and-programming.html#efficiency-considerations"><i class="fa fa-check"></i><b>7.5</b> Efficiency Considerations</a><ul>
<li class="chapter" data-level="7.5.1" data-path="functions-and-programming.html"><a href="functions-and-programming.html#growing-objects"><i class="fa fa-check"></i><b>7.5.1</b> Growing Objects</a></li>
<li class="chapter" data-level="7.5.2" data-path="functions-and-programming.html"><a href="functions-and-programming.html#vectorization"><i class="fa fa-check"></i><b>7.5.2</b> Vectorization</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="functions-and-programming.html"><a href="functions-and-programming.html#more-on-functions"><i class="fa fa-check"></i><b>7.6</b> More on Functions</a></li>
<li class="chapter" data-level="7.7" data-path="functions-and-programming.html"><a href="functions-and-programming.html#calling-functions"><i class="fa fa-check"></i><b>7.7</b> Calling Functions</a><ul>
<li class="chapter" data-level="7.7.1" data-path="functions-and-programming.html"><a href="functions-and-programming.html#the-...-argument"><i class="fa fa-check"></i><b>7.7.1</b> The <code>...</code> argument</a></li>
<li class="chapter" data-level="7.7.2" data-path="functions-and-programming.html"><a href="functions-and-programming.html#lazy-evaluation"><i class="fa fa-check"></i><b>7.7.2</b> Lazy Evaluation</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="functions-and-programming.html"><a href="functions-and-programming.html#homework-4"><i class="fa fa-check"></i><b>7.8</b> Homework</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sp.html"><a href="sp.html"><i class="fa fa-check"></i><b>8</b> Spatial Data Visualization and Analysis</a><ul>
<li class="chapter" data-level="8.1" data-path="sp.html"><a href="sp.html#overview"><i class="fa fa-check"></i><b>8.1</b> Overview</a><ul>
<li class="chapter" data-level="8.1.1" data-path="sp.html"><a href="sp.html#some-spatial-data-packages"><i class="fa fa-check"></i><b>8.1.1</b> Some Spatial Data Packages</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="sp.html"><a href="sp.html#motivating-data"><i class="fa fa-check"></i><b>8.2</b> Motivating Data</a></li>
<li class="chapter" data-level="8.3" data-path="sp.html"><a href="sp.html#reading-spatial-data-into-r"><i class="fa fa-check"></i><b>8.3</b> Reading Spatial Data into R</a></li>
<li class="chapter" data-level="8.4" data-path="sp.html"><a href="sp.html#coordinate-reference-systems"><i class="fa fa-check"></i><b>8.4</b> Coordinate Reference Systems</a></li>
<li class="chapter" data-level="8.5" data-path="sp.html"><a href="sp.html#ggmap"><i class="fa fa-check"></i><b>8.5</b> Illustration using <code>ggmap</code></a></li>
<li class="chapter" data-level="8.6" data-path="sp.html"><a href="sp.html#illustration-using-leaflet"><i class="fa fa-check"></i><b>8.6</b> Illustration using <code>leaflet</code></a></li>
<li class="chapter" data-level="8.7" data-path="sp.html"><a href="sp.html#subsetting-spatial-data"><i class="fa fa-check"></i><b>8.7</b> Subsetting Spatial Data</a><ul>
<li class="chapter" data-level="8.7.1" data-path="sp.html"><a href="sp.html#fetching-and-cropping-data-using-raster"><i class="fa fa-check"></i><b>8.7.1</b> Fetching and Cropping Data using <code>raster</code></a></li>
<li class="chapter" data-level="8.7.2" data-path="sp.html"><a href="sp.html#logical-index-and-name-subsetting"><i class="fa fa-check"></i><b>8.7.2</b> Logical, Index, and Name Subsetting</a></li>
<li class="chapter" data-level="8.7.3" data-path="sp.html"><a href="sp.html#spatial-subsetting-and-overlay"><i class="fa fa-check"></i><b>8.7.3</b> Spatial Subsetting and Overlay</a></li>
<li class="chapter" data-level="8.7.4" data-path="sp.html"><a href="sp.html#spatial-aggregation"><i class="fa fa-check"></i><b>8.7.4</b> Spatial Aggregation</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="sp.html"><a href="sp.html#where-to-go-from-here"><i class="fa fa-check"></i><b>8.8</b> Where to go from here</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Programming for Data Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="graphics-in-r" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Graphics in R</h1>
<p>R can be used to create a vast array of graphical representations of data. Creating “standard” graphical displays is straightforward, but a main strength of R is the ability to customize graphical displays to create either non-standard graphics or to modify more standard graphical displays to create publication-ready versions.</p>
<p>There are several packages available in R for creating graphics. The two leading packages are the <code>graphics</code> package, which comes with your base installation of R, and the <code>ggplot2</code> package, which must be installed and made available by the user.<a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a> Knowing how to use both the <code>graphics</code> and <code>ggplot2</code> packages is worthwhile. For beginners <code>ggplot2</code> has somewhat simpler syntax, and also produces excellent graphics without much tinkering, so the focus in this book will be on <code>ggplot2</code>.</p>
<p>The <code>gg</code> in <code>ggplot2</code> stands for <em>Grammar of Graphics</em>. The package provides a unified and logical way to describe graphical displays such as scatter plots, histograms, bar charts, and many other types of graphics. The grammar describes the mapping from data to the graphical display’s aesthetic attributes (color, shape, size) of geometric objects (points, lines, bars). As will become obvious, once this grammar is mastered for a particular type of plot, such as a scatter plot, it is easy to transfer this knowledge to other types of graphics.</p>
<p>Once you work through this chapter, the best place to learn more about <code>ggplot2</code> is from the package’s official book <span class="citation">Wickham and Sievert (<a href="#ref-WickhamGgplot2Book">2016</a>)</span> by Hadley Wickham. It is available on-line in digital format from MSU’s library. The book goes into much more depth on the theory underlying the grammar and syntax, and has many examples on solving practical graphical problems. In addition to the free on-line version available through MSU, the book’s source code is available at <a href="https://github.com/hadley/ggplot2-book" class="uri">https://github.com/hadley/ggplot2-book</a>.</p>
<p>Another useful resource is the <code>ggplot2</code> extensions guide <code>http://www.ggplot2-exts.org</code>. This site lists packages that extend <code>ggplot2</code>. It’s a good place to start if you’re trying to do something that seems hard with <code>ggplot2</code>. We’ll explore a few of these extension packages toward the end of this chapter.</p>
<div id="scatter-plots" class="section level2">
<h2><span class="header-section-number">5.1</span> Scatter Plots</h2>
<p>Scatter plots are a workhorse of data visualization and provide a good entry point to the <code>ggplot2</code> system. Begin by considering a simple and classic data set sometimes called <em>Fisher’s Iris Data</em>. These data are available in R.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">data</span>(iris)
<span class="op">&gt;</span><span class="st"> </span><span class="kw">str</span>(iris)</code></pre>
<p>The data contain measurements on petal and sepal length and width for <code>dim(iris)[1]</code> iris plants. The plants are from one of three species, and the species information is also included in the data frame. The data are commonly used to test classification methods, where the goal would be to correctly determine the species based on the four length and width measurements. To get a preliminary sense of how this might work, we can draw some scatter plots of length versus width. Recall that <code>ggplot2</code> is not available by default, so we first have to download and install the package.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)</code></pre>
<p>Once this is done the package is installed on the local hard drive, and we can use the <code>library</code> function to make the package available during the current R session.</p>
<p>Next a basic scatter plot is drawn. We’ll keep the focus on sepal length and width, but of course similar plots could be drawn using petal length and width. The prompt is not displayed below, since the continuation prompt <code>+</code> can cause confusion.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(<span class="dt">data =</span> iris, <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>()</code></pre>
<p>In this case the first argument to the <code>ggplot</code> function is the name of the data frame. Second, the <code>aes</code> (short for aesthetics) function specifies the mapping to the <code>x</code> and <code>y</code> axes. By itself the <code>ggplot</code> function as written doesn’t tell R what sort of graphical display is desired. That is done by adding a <code>geom</code> (short for geometry) specification, in this case <code>geom_point</code>.</p>
<p>Looking at the scatter plot and thinking about the focus of finding a method to classify the species, two thoughts come to mind. First, the plot might be improved by increasing the size of the points. And second, using different colors for the points corresponding to the three species would help.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> iris, <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">4</span>, <span class="kw">aes</span>(<span class="dt">color=</span>Species))</code></pre>
<p>Notice that a legend showing what the colors represent is automatically generated and included in the graphic. Next, the size of the points seems a bit big now, and it might be helpful to use different shapes for the different species.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> iris, <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>, <span class="kw">aes</span>(<span class="dt">color=</span>Species, <span class="dt">shape=</span>Species))</code></pre>
<p>Here we see that the legend automatically changes to include species specific color and shape. The size of the points seems more appropriate.</p>
<div id="structure-of-a-typical-ggplot" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Structure of a Typical <code>ggplot</code></h3>
<p>The examples above start with the function <code>ggplot()</code>, which takes as arguments the data frame containing the data to be plotted as well as a mapping from the data to the axes, enclosed by the <code>aes()</code> function. Next a <code>geom</code> function, in the above case <code>geom_point()</code>, is added. It might just specify the geometry, but also might specify aspects such as size, color, or shape.</p>
<p>Typically many graphics are created and discarded in the search for an informative graphic, and often the initial specification of data and basic aesthetics from <code>ggplot()</code> stays the same in all the attempts. In such a case it can be helpful to assign that portion of the graphic to an R object, both to minimize the amount of typing and to keep certain aspects of all the graphics constant. Here’s how that could be done for the graphics above.</p>
<pre class="sourceCode r"><code class="sourceCode r">iris.p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> iris, <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width))
iris.p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()
iris.p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>, <span class="kw">aes</span>(<span class="dt">color =</span> Species, <span class="dt">shape =</span> Species))</code></pre>
</div>
<div id="adding-lines-to-a-scatter-plot" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Adding lines to a scatter plot</h3>
<p>To add a fitted least squares line to a scatter plot, use <code>stat_smooth</code>, which adds a smoother (possibly a least squares line, possibly a smooth curve fit to the data, etc.). The argument <code>method = lm</code> specifies a line fitted by least squares, and the argument <code>se = FALSE</code> suppresses the default display of a confidence band around the line or curve which was fit to the data.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> iris, <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">3</span>, <span class="kw">aes</span>(<span class="dt">color=</span>Species))

<span class="kw">ggplot</span>(<span class="dt">data =</span> iris, <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">3</span>, <span class="kw">aes</span>(<span class="dt">color=</span>Species)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> lm, <span class="dt">se=</span><span class="ot">FALSE</span>)</code></pre>
<p>For the iris data, it probably makes more sense to fit separate lines by species. This can be specified using the <code>aes()</code> function inside <code>stat_smooth()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> iris, <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">3</span>, <span class="kw">aes</span>(<span class="dt">color=</span>Species)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> lm, <span class="dt">se=</span><span class="ot">FALSE</span>, <span class="kw">aes</span>(<span class="dt">color=</span>Species))</code></pre>
<p>In this case we specified the same color aesthetic for the points and the lines. If we know we want this color aesthetic (colors corresponding to species) for all aspects of the graphic, we can specify it in the main <code>ggplot()</code> function:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> iris, <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width, <span class="dt">color =</span> Species)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> lm, <span class="dt">se=</span><span class="ot">FALSE</span>)</code></pre>
<p>Another common use of line segments in a graphic is to connect the points in order, accomplished via the <code>geom_line()</code> function. Although it is not clear why this helps in understanding the iris data, the technique is illustrated next, first doing this for all the points in the graphic, and second doing this separately for the three species.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> iris, <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">4</span>, <span class="kw">aes</span>(<span class="dt">color=</span>Species, <span class="dt">shape =</span> Species)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_line</span>()</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> iris, <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">4</span>, <span class="kw">aes</span>(<span class="dt">color=</span>Species)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color=</span>Species))</code></pre>
</div>
</div>
<div id="labels-axes-text-etc." class="section level2">
<h2><span class="header-section-number">5.2</span> Labels, Axes, Text, etc.</h2>
<p>The default settings of <code>ggplot2</code> often produce excellent graphics, but once a graphic is chosen for dissemination, the user will likely want to customize things like the title, axes, etc. In this section some tools for customization are presented. Most will be illustrated in the context of a data set on crime rates in the 50 states in the United States. These data were made available by Nathan Yau at <a href="http://flowingdata.com/2010/11/23/how-to-make-bubble-charts/" class="uri">http://flowingdata.com/2010/11/23/how-to-make-bubble-charts/</a>. The data include crime rates per 100,000 people for various crimes such as murder and robbery, and also include each state’s population. The crime rates are from the year 2005, while the population numbers are from the year 2008, but the difference in population between the years is not great, and the exact population is not particularly important for what we’ll do below.</p>
<p>First, read in the data, examine its structure, and produce a simple scatter plot of motor vehicle theft versus burglary.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>u.crime &lt;-<span class="st"> &quot;http://blue.for.msu.edu/FOR875/data/crimeRatesByState2005.csv&quot;</span>
<span class="op">&gt;</span><span class="st"> </span>crime &lt;-<span class="st"> </span><span class="kw">read.csv</span>(u.crime, <span class="dt">header=</span><span class="ot">TRUE</span>)
<span class="op">&gt;</span><span class="st"> </span><span class="kw">str</span>(crime)
<span class="op">&gt;</span><span class="st"> </span><span class="kw">ggplot</span>(data &lt;-<span class="st"> </span>crime, <span class="kw">aes</span>(<span class="dt">x =</span> burglary, <span class="dt">y =</span> motor_vehicle_theft)) <span class="op">+</span><span class="st"> </span>
<span class="op">+</span><span class="st">     </span><span class="kw">geom_point</span>()</code></pre>
<div id="labels" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Labels</h3>
<p>By default axis and legend labels are the names of the relevant columns in the data frame. While convenient, we often want to customize these labels. Here we use <code>labs()</code> to change the x and y axis labels and other descriptive text.<a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> crime, <span class="kw">aes</span>(<span class="dt">x =</span> burglary, <span class="dt">y =</span> motor_vehicle_theft)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Burglaries per 100,000 population&quot;</span>, 
         <span class="dt">y =</span> <span class="st">&quot;Motor vehicle theft per 100,000 population&quot;</span>,
         <span class="dt">title =</span> <span class="st">&quot;Burglaries vs motor vehicle theft for US states&quot;</span>,
         <span class="dt">subtitle =</span> <span class="st">&quot;2005 crime rates and 2008 population&quot;</span>,
         <span class="dt">caption =</span> <span class="st">&quot;Data from Nathan Yau http://flowingdata.com&quot;</span>
         )</code></pre>
</div>
</div>
<div id="customizing-axes" class="section level2">
<h2><span class="header-section-number">5.3</span> Customizing Axes</h2>
<p><code>ggplot</code> also provides default axis extents (i.e., limits) and other axis features. These, and other axis features such as tick marks, labels, and transformations, can be changed using the scale functions. Here the range of the x and y axis is altered to start at zero and go to the maximum of the x and y variables.<a href="#fn21" class="footnote-ref" id="fnref21"><sup>21</sup></a> Here too, axis labels are specified within the scale function, which is an alterative to using the <code>labs()</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> crime, <span class="kw">aes</span>(<span class="dt">x =</span> burglary, <span class="dt">y =</span> motor_vehicle_theft)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Burglaries per 100,000 population&quot;</span>, 
                       <span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(crime<span class="op">$</span>burglary))) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Motor vehicle theft per 100,000 population&quot;</span>, 
                       <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">max</span>(crime<span class="op">$</span>motor_vehicle_theft)))</code></pre>
<div id="text-point-size-and-color" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Text, Point Size, and Color</h3>
<p>Next we make point size proportional to population, change the color, and add a state label. Note, in the <code>ggplot()</code> call I scaled <code>population</code> by 100,000 to help with the interpretability of the legend. Accordingly, I also changed the “population” label on the legend to “Population\n(100,000)” using the <code>labs()</code> function<a href="#fn22" class="footnote-ref" id="fnref22"><sup>22</sup></a>. We use the <code>geom_label()</code> function to add the label, which provides an outline around the label text and allows you to control the box characteristics, e.g., I make the boxes slightly transparent using the <code>alpha</code> argument.<a href="#fn23" class="footnote-ref" id="fnref23"><sup>23</sup></a></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> crime, <span class="kw">aes</span>(<span class="dt">x =</span> burglary, <span class="dt">y =</span> motor_vehicle_theft, 
           <span class="dt">size=</span>population<span class="op">/</span><span class="dv">100000</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_label</span>(<span class="kw">aes</span>(<span class="dt">label =</span> state), <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Burglaries per 100,000 population&quot;</span>, 
                       <span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(crime<span class="op">$</span>burglary))) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Motor vehicle theft per 100,000 population&quot;</span>, 
                       <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">max</span>(crime<span class="op">$</span>motor_vehicle_theft))) <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">size=</span><span class="st">&quot;Population</span><span class="ch">\n</span><span class="st">(100,000)&quot;</span>)</code></pre>
<p>The labels are helpful but just too cluttered. There are some additional arguments that can go into <code>geom_label()</code> that allow for label offset; however, this won’t help us much here. Instead, we can try the <code>ggrepel</code> package by Kamil Slowikowski. This useful package will automatically adjust labels so that they don’t overlap. First we need to download and add the package using either RStudio’s install package buttons or via <code>install.packages(&quot;ggrepel&quot;)</code>. Next to make all of <code>ggrepel</code>’s functions available we can call <code>library(ggrepel)</code> function or, if we know which function we want, we can load only that particular function using the <code>::</code> operators. I use <code>::</code> below to make clear which function is coming from <code>ggrepel</code> and which is coming from <code>ggplot2</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> crime, <span class="kw">aes</span>(<span class="dt">x =</span> burglary, <span class="dt">y =</span> motor_vehicle_theft, 
           <span class="dt">size=</span>population<span class="op">/</span><span class="dv">100000</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Burglaries per 100,000 population&quot;</span>, 
                       <span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(crime<span class="op">$</span>burglary))) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Motor vehicle theft per 100,000 population&quot;</span>, 
                       <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">max</span>(crime<span class="op">$</span>motor_vehicle_theft))) <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">size=</span><span class="st">&quot;Population</span><span class="ch">\n</span><span class="st">(100,000)&quot;</span>) <span class="op">+</span>
<span class="st">    </span>ggrepel<span class="op">::</span><span class="kw">geom_label_repel</span>(<span class="kw">aes</span>(<span class="dt">label =</span> state), <span class="dt">alpha =</span> <span class="fl">0.5</span>)</code></pre>
<p>This looks a bit better. We’ll resist making additional improvements to the figure for now.</p>
</div>
</div>
<div id="other-types-of-graphics" class="section level2">
<h2><span class="header-section-number">5.4</span> Other Types of Graphics</h2>
<p>Scatter and line plots, which have just been presented, are common but certainly not the only graphical displays in common use. Histograms, boxplots, and bar graphs, as well as more “mathematical” displays such as the graph of a function, are commonly used to represent data. Examples of each are presented below.</p>
<div id="histograms" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Histograms</h3>
<p>Simon Newcomb conducted several experiments to estimate the speed of light by measuring the time it took for light to travel from his laboratory to a mirror at the base of the Washington Monument, and then back to his lab. This is a distance of <span class="math inline">\(7.44373\)</span> km, and by dividing this distance by the measured time, an estimate for the speed of light is obtained.</p>
<p>The times are of course quite small, and to avoid working with very small numbers, the data are recoded to be the deviation from <span class="math inline">\(24800\)</span> nanoseconds. For example an observation coded as <span class="math inline">\(28\)</span> represents a time of <span class="math inline">\(24828\)</span> nanoseconds, while an observation coded as <span class="math inline">\(-44\)</span> represents a time of <span class="math inline">\(24756\)</span> nanoseconds.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>u.newcomb &lt;-<span class="st"> &quot;http://blue.for.msu.edu/FOR875/data/Newcomb.csv&quot;</span>
<span class="op">&gt;</span><span class="st"> </span>Newcomb &lt;-<span class="st"> </span><span class="kw">read.csv</span>(u.newcomb, <span class="dt">header =</span> <span class="ot">TRUE</span>)
<span class="op">&gt;</span><span class="st"> </span><span class="kw">head</span>(Newcomb)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(Newcomb, <span class="kw">aes</span>(<span class="dt">x =</span> Time)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>()</code></pre>
<p>The software has an algorithm to calculate bin widths for the histogram. Sometimes the algorithm makes choices that aren’t suitable (hence the R message above), and these can be changed by specifying a <code>binwidth</code>. In addition, the appearance of the bars also can be changed.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(Newcomb, <span class="kw">aes</span>(<span class="dt">x =</span> Time)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">5</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;blue&quot;</span> )</code></pre>
</div>
<div id="boxplots" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Boxplots</h3>
<p>Next we consider some data from the gap minder data set to construct some box plots. These data are available in the <code>gapminder</code> package, which might need to be installed via <code>install.packages(&quot;gapminder&quot;)</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gapminder)
<span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">subset</span>(gapminder,  year <span class="op">==</span><span class="st"> </span><span class="dv">2002</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> continent, <span class="dt">y =</span> gdpPercap)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>)</code></pre>
<p>Here’s the same set of boxplots, but with different colors, different axis labels, and the boxes plotted horizontally rather than vertically.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">subset</span>(gapminder,  year <span class="op">==</span><span class="st"> </span><span class="dv">2002</span>), 
       <span class="kw">aes</span>(<span class="dt">x =</span> continent, <span class="dt">y =</span> gdpPercap)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">scale_x_discrete</span>(<span class="dt">name =</span> <span class="st">&quot;Continent&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;Per Capita GDP&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>()</code></pre>
</div>
<div id="bar-graphs" class="section level3">
<h3><span class="header-section-number">5.4.3</span> Bar Graphs</h3>
<p>As part of a study, elementary school students were asked which was more important to them: good grades, popularity, or athletic ability. Here is a brief look at the data.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>u.goals &lt;-<span class="st"> &quot;http://blue.for.msu.edu/FOR875/data/StudentGoals.csv&quot;</span>
<span class="op">&gt;</span><span class="st"> </span>StudentGoals &lt;-<span class="st"> </span><span class="kw">read.csv</span>(u.goals, <span class="dt">header =</span> <span class="ot">TRUE</span>)
<span class="op">&gt;</span><span class="st"> </span><span class="kw">head</span>(StudentGoals)</code></pre>
<p>First, a simple bar graph of the most important goal chosen is drawn, followed by a stacked bar graph which also includes the student’s gender. We then add a side by side bar graph that includes the student’s gender.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(StudentGoals, <span class="kw">aes</span>(<span class="dt">x =</span> Goals)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>()
<span class="kw">ggplot</span>(StudentGoals, <span class="kw">aes</span>(<span class="dt">x =</span> Goals, <span class="dt">fill =</span> Gender)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>()
<span class="kw">ggplot</span>(StudentGoals, <span class="kw">aes</span>(<span class="dt">x =</span> Goals, <span class="dt">fill =</span> Gender)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)</code></pre>
<p>In this example R counted the number of students who had each goal and used these counts as the height of the bars. Sometimes the data contain the bar heights as a variable. For example, we create a bar graph of India’s per capita GDP with separate bars for each year in the data<a href="#fn24" class="footnote-ref" id="fnref24"><sup>24</sup></a>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="kw">subset</span>(gapminder, country <span class="op">==</span><span class="st"> &quot;India&quot;</span>), <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> gdpPercap)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;steelblue2&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;India&#39;s per-capita GDP&quot;</span>)</code></pre>
</div>
<div id="graphs-of-functions" class="section level3">
<h3><span class="header-section-number">5.4.4</span> Graphs of Functions</h3>
<p>One way to create a plot of a mathematical function <span class="math inline">\(f\)</span> is to create a data frame with <span class="math inline">\(x\)</span> values in one column and <span class="math inline">\(f(x)\)</span> values in another column, and then draw a line plot.</p>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span>pi, pi, <span class="dt">len =</span> <span class="dv">1000</span>)
sin.data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> <span class="kw">sin</span>(x))
<span class="kw">ggplot</span>(<span class="dt">data =</span> sin.data, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;sin(x)&quot;</span>)</code></pre>
<p>This method works well, but with a better understanding of functions in R we will be able to plot mathematical functions in a simpler and more natural way.</p>
</div>
</div>
<div id="themes" class="section level2">
<h2><span class="header-section-number">5.5</span> Themes</h2>
<p>The theme defines non-data aspects of the plot’s characteristics such as background color, axes, and grid lines. Default themes include: <code>theme_bw()</code>, <code>theme_classic()</code>, <code>theme_dark()</code>, <code>theme_gray()</code>, <code>theme_light()</code>, <code>theme_linedraw()</code>, <code>theme_minimal()</code>, and <code>theme_void()</code>. Changing the theme is as easy as adding it to your initial <code>ggplot()</code> call. Here I replace the default implicit <code>theme_bw()</code> theme with the classic theme.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> sin.data, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;sin(x)&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_classic</span>()</code></pre>
<p>The <code>ggthemes</code> add-on package [<a href="https://github.com/jrnold/ggthemes" class="uri">https://github.com/jrnold/ggthemes</a>] by Jeffrey Arnold provides a large selection of themes beyond the eight themes that come with <code>ggplot2</code>.</p>
</div>
<div id="saving-graphics" class="section level2">
<h2><span class="header-section-number">5.6</span> Saving Graphics</h2>
<p>We often want to export our graphics to use in an external document or share with colleagues. There are several ways to save graphics in a variety of file formats. The <code>ggsave()</code> function will allow you to save your most recent <code>ggplot()</code> to a variety of vector (e.g., “eps”, “ps”, “pdf”, “svg”) or raster (e.g., “jpeg”, “tiff”, “png”, “bmp”, “wmf”) formats.<a href="#fn25" class="footnote-ref" id="fnref25"><sup>25</sup></a> The subsequent call to <code>ggsave()</code> saves the <code>sin.data</code> plot to a pdf file called “sin-plot.pdf”.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">filename =</span> <span class="st">&quot;sin-plot.pdf&quot;</span>, <span class="dt">device=</span><span class="st">&quot;pdf&quot;</span>)</code></pre>
<p>The <code>ggplot()</code> function takes additional arguments to control scale, measurement units, and raster plot resolution, i.e., dots per inch (dpi).</p>
</div>
<div id="more-resources" class="section level2">
<h2><span class="header-section-number">5.7</span> More Resources</h2>
<p>In summary, <code>ggplot2</code> provides a fairly intuitive<a href="#fn26" class="footnote-ref" id="fnref26"><sup>26</sup></a> framework for developing an enormous variety of graphics. In addition to the resources mentioned at the beginning of this chapter, there are numerous online <code>ggplot2</code> resources and galleries to get ideas for creating beautiful graphics to convey the stories in your data. See, for example,</p>
<ul>
<li><a href="http://docs.ggplot2.org" class="uri">http://docs.ggplot2.org</a></li>
<li><a href="http://www.r-graph-gallery.com/portfolio/ggplot2-package" class="uri">http://www.r-graph-gallery.com/portfolio/ggplot2-package</a></li>
<li><a href="http://www.ggplot2-exts.org/gallery" class="uri">http://www.ggplot2-exts.org/gallery</a></li>
<li><a href="http://www.cookbook-r.com/Graphs" class="uri">http://www.cookbook-r.com/Graphs</a></li>
<li>and of course www.google.com</li>
</ul>
<p>While the built-in <code>ggplot2</code> package documentation (accessible via the help tab in RStudio) is helpful, the official online documentation at <a href="http://docs.ggplot2.org" class="uri">http://docs.ggplot2.org</a> is particularly useful because it provides example plots and easy navigation between related topics. The large number number of functions and syntax in <code>ggplot2</code> can be daunting. RStudio provides some handy cheatsheets to help you along www.rstudio.com/resources/cheatsheets or direct link www.rstudio.com/wp-content/uploads/2016/11/ggplot2-cheatsheet-2.1.pdf.</p>
<p><code>ggplot2</code> also has an active mailing list at <a href="http://groups.google.com/group/ggplot2" class="uri">http://groups.google.com/group/ggplot2</a>. The list is an excellent resource for users at all stages of experience. Another useful resource is stackoverflow, <a href="http://stackoverflow.com" class="uri">http://stackoverflow.com</a>. There is an active <code>ggplot2</code> community on stackoverflow, and many common questions have already been asked and answered. When posting questions on any programming mailing list, it is best to provide a minimal reproducible example of your issue. The <code>reprex</code> <a href="https://github.com/jennybc/reprex" class="uri">https://github.com/jennybc/reprex</a> package by Jenny Bryan provides a convenient way to do this, and also includes advice on creating a good example. The more information you provide about your issue, the more likely the community is to help you.</p>
</div>
<div id="practice-exercises-2" class="section level2">
<h2><span class="header-section-number">5.8</span> Practice Exercises</h2>
</div>
<div id="homework-2" class="section level2">
<h2><span class="header-section-number">5.9</span> Homework</h2>
<p><strong>Exercise 6</strong> Learning objectives: practice using <code>ggplot2</code> functions; summarize variables using graphics; introduce <code>ggplot2</code> facets.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-WickhamGgplot2Book">
<p>Wickham, Hadley, and Carson Sievert. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. 2nd ed. Cham: Springer.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="19">
<li id="fn19"><p>Other graphics packages include <code>lattice</code> and <code>grid</code><a href="graphics-in-r.html#fnref19" class="footnote-back">↩</a></p></li>
<li id="fn20"><p>Axis and legend labels can also be set in the individual scales, see the subsequent sections.<a href="graphics-in-r.html#fnref20" class="footnote-back">↩</a></p></li>
<li id="fn21"><p><code>ggplot2</code> makes the axes extend slightly beyond the given range, since typically this is what the user wants.<a href="graphics-in-r.html#fnref21" class="footnote-back">↩</a></p></li>
<li id="fn22"><p>The \n is the line break and puts “(100,000)” below “Population”.<a href="graphics-in-r.html#fnref22" class="footnote-back">↩</a></p></li>
<li id="fn23"><p>You can also add labels via <code>geom_text()</code> function or a <code>label</code> argument in the <code>ggplot()</code> call.<a href="graphics-in-r.html#fnref23" class="footnote-back">↩</a></p></li>
<li id="fn24"><p>R offers a large color palette, run <code>colors()</code> on the console to see a list of color names.<a href="graphics-in-r.html#fnref24" class="footnote-back">↩</a></p></li>
<li id="fn25"><p>Vector files comprise lines and curves known as paths, whereas raster files are comprised of pixels. Vector images are often preferred for publication quality graphics because they can be edited, scale well, and provide crisper detail.<a href="graphics-in-r.html#fnref25" class="footnote-back">↩</a></p></li>
<li id="fn26"><p>Like everything else in this book, it takes practice to get used to the syntax.<a href="graphics-in-r.html#fnref26" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="structures.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yihui/bookdown-crc/edit/master/05-graphics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["bookdown.pdf", "bookdown.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
